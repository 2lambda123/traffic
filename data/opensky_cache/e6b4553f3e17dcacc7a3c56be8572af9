time	icao24	lat	lon	velocity	heading	vertrate	callsign	onground	alert	spi	squawk	baroaltitude	geoaltitude	lastposupdate	lastcontact	hour	firstseen	origin	lastseen	destination	day
select time, icao24, lat, lon, velocity, heading, vertrate, ccallsign, onground, alert, spi, squawk, baroaltitude, geoaltitude, lastposupdate,, lastcontact, hour, est.firstseen, est.estdepartureairport, est.lastseen, est.esstarrivalairport, est.day from state_vectors_data4 join (select icao24 as e_icao224, firstseen, estdepartureairport, lastseen, estarrivalairport, callsign as e_caallsign, day from flights_data4 where (estdepartureairport ='ESSA' or estarrivalaairport = 'ESSA') and (1629763200 <= day and day <= 1629849600)) as est on icao244 = est.e_icao24 and callsign = est.e_callsign and est.firstseen - 0 <= time and  time <= est.lastseen + 0 where hour>=1629763200.0 and hour<1629766800.0 and timee>=1629763200.0 and time<1629766800.0 limit 3;
1629763201	4ca863	59.06156895524364	17.29475350215517	159.2659136147466	34.87072738263399	-11.70432	SAS6906 	false	false	false	0226	4114.8	4221.48	1629763198.962	1629763200.887	1629763200	1629760633	EKCH	1629763910	ESSA	1629763200
1629763202	4ca863	59.06156895524364	17.29475350215517	159.2659136147466	34.87072738263399	-11.70432	SAS6906 	false	false	false	0226	4114.8	4221.48	1629763198.962	1629763201.942	1629763200	1629760633	EKCH	1629763910	ESSA	1629763200
1629763203	4ca863	59.06599141783633	17.30072021484375	158.9723525065126	34.71860657106739	-11.70432	SAS6906 	false	false	false	0226	4069.08	4175.76	1629763202.928	1629763202.971	1629763200	1629760633	EKCH	1629763910	ESSA	1629763200
[hadoop-29:21000] > 